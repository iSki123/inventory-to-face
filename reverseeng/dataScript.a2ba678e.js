var e,r;"function"==typeof(e=globalThis.define)&&(r=e,e=null),function(r,t,a,s,o){var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n="function"==typeof l[s]&&l[s],i=n.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function g(e,t){if(!i[e]){if(!r[e]){var a="function"==typeof l[s]&&l[s];if(!t&&a)return a(e,!0);if(n)return n(e,!0);if(c&&"string"==typeof e)return c(e);var o=Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}p.resolve=function(t){var a=r[e][1][t];return null!=a?a:t},p.cache={};var m=i[e]=new g.Module(e);r[e][0].call(m.exports,p,m,m.exports,this)}return i[e].exports;function p(e){var r=p.resolve(e);return!1===r?{}:g(r)}}g.isParcelRequire=!0,g.Module=function(e){this.id=e,this.bundle=g,this.exports={}},g.modules=r,g.cache=i,g.parent=n,g.register=function(e,t){r[e]=[function(e,r){r.exports=t},{}]},Object.defineProperty(g,"root",{get:function(){return l[s]}}),l[s]=g;for(var m=0;m<t.length;m++)g(t[m]);if(a){var p=g(a);"object"==typeof exports&&"undefined"!=typeof module?module.exports=p:"function"==typeof e&&e.amd?e(function(){return p}):o&&(this[o]=p)}}({VvubE:[function(e,r,t){var a=e("@parcel/transformer-js/src/esmodule-helpers.js"),s=e("~utils/getVehicleDetails"),o=a.interopDefault(s);async function l(e,r,t,a){let s=await (0,o.default)(e,r,t,a);return chrome.runtime.sendMessage({message:"postToFacebook",vehicleDetails:s,url:r}),s}chrome.runtime.onMessage.addListener(async(e,r,t)=>{if(e?.message==="runDataScript"){let r=await l(e?.vehicleDetails,e?.url,e?.isFirstPrice,e?.firstPrice);chrome.runtime.sendMessage({message:"scrapingComplete",vehicleDetails:r})}return!0})},{"~utils/getVehicleDetails":"gl4ht","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],gl4ht:[function(e,r,t){e("@parcel/transformer-js/src/esmodule-helpers.js").defineInteropFlag(t);var a=e("./helping");async function s(e,r,t,s){try{let o={};if(await (0,a.asyncSleep)(2),!e)return{};let{description:l,images_block:n,mileage:i,price:c,year_make_model:g,all_vehicles_button:m,styling:p}=e,u=n,d="",f="",A="",h="",x="",w=g,y=m,b=null,v="",T="",S=0,k=!1,E=null;try{if(p?.includes("imageFormat")&&(k=!0),p?.includes("@@")){let e=p?.match(/@@(.*?)@@/);e?.[1]&&(E=e[1])}}catch(e){console.error("Error processing styling:",e)}let P=null,C="L",I=!1,D="";if(y)try{let e=y.match(/\{([^:}]+):([LR])\}/);e&&([,P,C]=e,y=y.replace(e[0],""));let r=y.match(/scroll\s+(.+)$/i);r&&(I=!0,D=r[1].trim().replace(/&&.*&&/,"").trim())}catch(e){console.error("Error parsing milesInstruction:",e)}await (0,a.asyncSleep)(1);let _=w?.match(/\{(.*?)\}/);_&&(b=_[1],w=w?.replace(_[0],""));let M=document.querySelector(w);M&&(T=a.CleanText(M?.innerText)?.replace("\n"," "),b&&(T=T.replace(RegExp(b,"gi"),"").trim()));let[F="",j="",O=""]=T.split(" "),L=c;if(L.includes("{")){let e=L?.match(/\{(.*?)\}/);e?.[1]&&(v=e[1],L=L?.replace(e[0],""))}let U="";if(t)U=s;else{let e=document.querySelector(L);(U=e?.innerText||"")||(U=e?.textContent||"")}U=U?.replace(/\s+/g,"").trim(),U=(0,a.CleanText)(U),v&&(U=U.replace(v,""));let $=parseInt(U,10)||0;if(E){let e=document.querySelector(E);e&&(e?.click(),await (0,a.asyncSleep)(1))}let q=i;if(q?.includes("{")){let e=q.match(/\{(.*?)\}/);e?.[1]&&(q=q?.replace(e[0],""))}let N=document.querySelector(q),R=N?.textContent?.trim()||N?.innerText?.trim()||"";S=P?(0,a.CleanText)((0,a.extractMilesFunction)(P,R,C).toString()):(0,a.CleanText)(R);let B=document.querySelector(l),W=B?.innerText||"";if(u.includes("(")){let e=u.match(/\((.*?)\)/);if(e?.[1]){let[r,t]=e[1].split(":");d=r||"",f=t||"",u=u.replace(e[0],"")}}if(u.includes("{")){let e=u.match(/\{(.*?)\}/);e?.[1]&&(A=e[1],u=u.replace(e[0],""))}if(u.includes("&")){let e=u.match(/\&(.*?)\&/);e?.[1]&&(h=e[1],u=u.replace(e[0],""))}if(u.includes("@@")){let e=u.match(/\@\@(.*?)\@\@/);e?.[1]&&(x=e[1],u=u.replace(e[0],""))}if(A){let e=document.querySelector(A);e&&(e.click(),await (0,a.asyncSleep)(2))}if(h){let e=document.querySelector(h);e&&(e.click(),await (0,a.asyncSleep)(2))}if(!u)return{year:F,make:j,model:O,price:$,mileage:S,sellerNotes:W,imagesUrl:[],url:r};let V=document.querySelector(".modal-scroll-panel");V&&((0,a.scrollTillBottom)(V),await (0,a.asyncSleep)(1));let G=[],H=[],z=[],Z=u.includes("DivImgFormat");if(Z){let e=u.replace("DivImgFormat",""),r=Array.from(document.querySelectorAll(e)),t=(0,a.getImageUrls)(r);G=(0,a.processImageUrls)(t,d,f,x)}else{let e=Array.from(document.querySelectorAll(`${u} img`));if(k){let e=Array.from(document.querySelectorAll(`${u} image`));H=e.flatMap(e=>[e?.src,e?.dataset?.src,e?.dataset?.highres,e?.href?.baseVal])}if(z=[...e.flatMap(e=>[e?.src,e?.dataset?.src,e?.dataset?.highres]),...H],G=(0,a.processImageUrls)(z,d,f,x),I){let e=await (0,a.collectSliderImages)(u,D);G=[...new Set(e)],G=(0,a.removeEmptyElement)(G),G=(0,a.removeUndefinedElements)(G),G=(0,a.removeDuplicateElements)(G),G=(0,a.processImageUrls)(G,d,f,x)}}return await (0,a.asyncSleep)(1),o={year:F,make:j,model:O,price:$,mileage:S,sellerNotes:W,imagesUrl:G,url:r},(0,a.asyncSleep)(1),o}catch(e){return console.error("getVehicleDetails error:",e),{}}}t.default=s},{"./helping":"eBThj","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],eBThj:[function(e,r,t){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(t),a.export(t,"urlToBase64",()=>w),a.export(t,"processImageUrls",()=>eu),a.export(t,"getFBUrl",()=>en),a.export(t,"uploadImagesFbGroups",()=>J),a.export(t,"cleanString",()=>W),a.export(t,"cleanSellerDesc",()=>V),a.export(t,"uploadImagesFbEvent",()=>G),a.export(t,"cleanText",()=>H),a.export(t,"cleanTextForGroup",()=>z),a.export(t,"clickDiscussionTab",()=>Z),a.export(t,"findDivWithText",()=>R),a.export(t,"updatePostedVehicleData",()=>ep),a.export(t,"saveVehicleData",()=>em),a.export(t,"extractGroupTitle",()=>er),a.export(t,"ListVehicleOnLocalStorage",()=>eg),a.export(t,"getclientDataFromServer",()=>ec),a.export(t,"AIDescription",()=>ei),a.export(t,"checkIfAdded",()=>eo),a.export(t,"checkIfPosted",()=>es),a.export(t,"getAlreadyAddedGroups",()=>ea),a.export(t,"getClientData",()=>et),a.export(t,"saveFbGroupsOnServer",()=>ee),a.export(t,"findWebsiteDetails",()=>g),a.export(t,"SaveWebsiteInfoInLocal",()=>X),a.export(t,"preparePromptForOpenAI",()=>K),a.export(t,"getGroupUrl",()=>Y),a.export(t,"getWhereToPostData",()=>Q),a.export(t,"waitForElement",()=>l),a.export(t,"SaveFbGroup",()=>N),a.export(t,"SaveGroupsData",()=>q),a.export(t,"getSiteFromLocalStorage",()=>$),a.export(t,"uploadImages",()=>b),a.export(t,"removeDuplicateElements",()=>U),a.export(t,"getPreviousPostedVehiclesFromLocalStorage",()=>M),a.export(t,"updateDataOnLocalStorage",()=>_),a.export(t,"refresh",()=>L),a.export(t,"getSiteDetailsFromStorage",()=>m),a.export(t,"getAllowedSites",()=>O),a.export(t,"getPreviousPostedVehicles",()=>j),a.export(t,"updateDataOnServer",()=>D),a.export(t,"cleanLocalStorageObject",()=>I),a.export(t,"updateCurrentPageUrl",()=>C),a.export(t,"isWebsiteAllowed",()=>S),a.export(t,"getWebsiteName",()=>u),a.export(t,"extractMileage",()=>T),a.export(t,"uploadImage",()=>y),a.export(t,"waitForTabToLoad",()=>x),a.export(t,"enterText",()=>A),a.export(t,"findElementWithText",()=>h),a.export(t,"extractPrice",()=>d),a.export(t,"asyncSleep",()=>c),a.export(t,"removeUndefinedElements",()=>f),a.export(t,"getWebsiteInfo",()=>n),a.export(t,"removeEmptyElement",()=>i),a.export(t,"getSiteDetails",()=>p),a.export(t,"CleanText",()=>o),a.export(t,"listVehicleOnServer",()=>B),a.export(t,"extractMilesFunction",()=>v),a.export(t,"scrollTillBottom",()=>k),a.export(t,"getImageUrls",()=>P),a.export(t,"collectSliderImages",()=>E);var s=e("~common/browserMethods");function o(e){return e=e?.replace(",","")?.replace("Miles","")?.replace("Miles ","")?.replace(" Miles","")?.replace(" Miles ","").replace("miles","").replace("MILES","").replace("km","").replace("KM","").replace("mile","").replace("mi.","").replace("mi","").replace("Mileage: ","").replace("Mileage:","").replace("Mileage","").replace("Mileage ","").replace("mileage","").replace(" miles Odometer","").replace("miles Odometer","").replace("Odometer","").replace(" Odometer","").replace("Odometer ","").replace("miles ","").replace("\u2022","").replace("New","").replace("NEW","").replace("Used","").replace("USED","").replace("Certified","").replace("certified","").replace("CERTIFIED","").replace("CERTIFIED PRE OWNED","").replace("certified pre owned","").replace("PRE OWNED","").replace("used","").replace("new","").replace("PRE-OWNED","").replace("Pre-owned","").replace("Pre-Owned","").replace("Certified Pre Owned","").replace("PRE OWNED","").replace("Pre Owned","").replace("Year:","").replace("Make:","").replace("Model:","").replace("Price:","").replace("PRICE:","").replace("PRICE","").replace("price:","").replace("price","").replace("Price","").replace("$","").replace("L/Certified","").replace("L/","").replace("Certified Pre-Owned","").replace("/","").replaceAll(",","").replaceAll("$","").replaceAll(".","").replaceAll("USD","").replaceAll("\u20ac","").replaceAll("\xa3","").replaceAll("Details","").replaceAll("DETAILS","").replaceAll("Details:","").replaceAll("INTERNET PRICE","").replaceAll("Condition:","").replaceAll("Condition","").replaceAll("Model:","").replaceAll("Make:","").replaceAll("Model","").replaceAll("Make","").replaceAll("Stock #:","").replaceAll("Stock #","").replaceAll("Stock","").replaceAll("Stock:","")?.replaceAll("MSRP:","")?.replaceAll("MSRP","")?.replaceAll("msrp","")?.replaceAll("msrp:","").trim()}async function l(e,r=3e4,t=500){let a=Date.now()+r;for(;Date.now()<a;){let r=document.querySelector(e);if(r)return r;await new Promise(e=>setTimeout(e,t))}return null}async function n(e){let r=await fetch("https://sag.gemquery.com/api/v1/get-website",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({website_url:e})}),t=await r?.json();if(t.success)return t?.website}function i(e){return e?.filter(e=>""!==e)?.filter((e,r,t)=>t?.indexOf(e)===r)}function c(e){return new Promise(r=>setTimeout(r,1e3*e))}function g(e,r){let t=r?.find(r=>r?.website_url===e);return t||null}async function m(){await c(2);let e=u(),r=n(e);return r||(r?void 0:null)}async function p(){await c(1);let e=u(),r=await chrome.storage.local.get("siteDetails"),t=g(e,r.siteDetails);if(t)return t}function u(){let e=window.location.href,r=e?.split("/"),t=r[2],a=t?.replace("www.","")?.replace(".com","");return a}function d(e){let r=/\$\s?([\d,]+)/.exec(e);return r?r[1]?.replace(/,/g,""):null}function f(e){return e?.filter(e=>void 0!==e)}let A=(e,r)=>{e?.focus(),document.execCommand("insertText",!1,r)},h=(e,r)=>{try{let t=Array.from(document.querySelectorAll(e));return t?.find(e=>e instanceof HTMLElement&&e?.innerText.trim()===r)}catch(e){return console.error("Error finding element:",e),null}};async function x(){return new Promise(e=>{let r=setInterval(()=>{"complete"===document.readyState&&(clearInterval(r),e(!0))},100)})}let w=async e=>{let r=await fetch(e),t=await r.blob(),a=new FileReader;return new Promise(e=>{a.onloadend=()=>e(a.result),a.readAsDataURL(t)})};async function y(e){try{let r=await new Promise(r=>{chrome.runtime.sendMessage({type:"fetch-image",url:e},e=>{e?.type==="image-fetched"?r(e.base64):(console.error("Failed to fetch image:",e),r(null))})});if(!r)throw Error("Failed to fetch image from background script");let t=r.split(",")[1],a=r.split(";")[0].split(":")[1],s=atob(t),o=Array(s.length);for(let e=0;e<s.length;e++)o[e]=s.charCodeAt(e);let l=new Uint8Array(o),n=new File([l],"image.jpg",{type:a}),i=document.querySelectorAll('span[dir="auto"]'),c=Array.from(i).find(e=>e.textContent?.toLowerCase()==="add photos/videos"||e.textContent?.toLowerCase()==="add photos"||e.textContent?.toLowerCase()==="add photo"||e.textContent?.toLowerCase()==="upload");if(!c)throw Error("Upload button not found");let g=new DataTransfer;g.items.add(n);let m=new DragEvent("drop",{bubbles:!0,dataTransfer:g});c.dispatchEvent(m)}catch(r){console.error(`Failed to fetch or process image ${e}:`,r)}}async function b(e,r){await G(e)}function v(e,r,t){try{if("string"!=typeof e||"string"!=typeof r||"L"!==t&&"R"!==t)return 0;let a=e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),s=RegExp(a,"i"),o=s.exec(r);if(!o)return 0;let l=o.index,n="L"===t?r.slice(0,l):r.slice(l+o[0].length),i=n.match(/[\d,]+/g);if(!i||0===i.length)return 0;let c="L"===t?i[i.length-1]:i[0],g=c.replace(/,/g,""),m=parseInt(g,10);return isNaN(m)?0:m}catch(e){return console.error("extractMiles error:",e),0}}function T(e){try{if(e?.includes("\xb7"))return e?.split("\xb7")[1]?.trim();return e?.trim()}catch(e){return console.error("Error extracting mileage:",e),""}}async function S(e,r){let t;let a=await chrome.storage.local.get("isAuthenticated");a&&"true"===(t=a.isAuthenticated)&&(t=!0);let s=e?.split(",")?.map(e=>e?.trim()),o=!1,l=s?.includes(r);return!0===l&&!0===t&&(o=!0),(!1===l||!1===t)&&(o=!1),o}let k=e=>{e?.scroll({top:e?.scrollHeight,left:0,behavior:"smooth"})},E=async(e,r,t=20)=>{let a=new Set,s=()=>{let r=document.querySelector(e);r&&Array.from(r.querySelectorAll("img")).forEach(e=>{let r=e.src||e.getAttribute("src")||"";r&&a.add(r)})};s();let o=document.querySelector(r);if(!o)return Array.from(a);for(let e=0;e<t;e++){try{o.click()}catch{}await new Promise(e=>setTimeout(e,800)),s()}return Array.from(a)};function P(e){let r=[];for(let t of e){let e=t?.style?.backgroundImage,a=e?.split('"')[1];r.push(a)}return r}async function C(e){if(!e)return;let r=await chrome.tabs.query({active:!0});chrome.tabs.update(r[0].id,{url:e})}function I(e){return{emoji:e?.emoji?.replace(/\"/g,""),imageBlog:e?.imageBlog,isAuthenticated:e?.isAuthenticated==="true",isMileAge:e?.isMileAge==="true",mileUnit:e?.mileUnit?.replace(/\"/g,""),password:e?.password?.replace(/\"/g,""),shouldAddSellerNotes:e?.shouldAddSellerNotes==="true",userId:e?.userId?.replace(/\"/g,""),vehicleCategory:e?.vehicleCategory?.replace(/\"/g,""),description:e?.description?.replace(/\"/g,"")}}let D=async(e,r)=>{let t=[];try{let a=await fetch(`https://social-auto-server.vercel.app/api/allClients/${r}`),s=await a.json();s=s[0];let{postedWebsites:o}=s;o.length>0&&(t=o);let l=Array.from(new Set([...t,e])),n={...s,postedWebsites:l};await fetch(`https://social-auto-server.vercel.app/api/allClients/${r}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})}catch(e){console.log(e)}},_=async(e,r)=>{let t=[],a=[],s=await chrome.storage.local.get(r);s?a=Array.from(new Set([...t,e])):chrome.storage.local.set({[r]:[e]}),s&&(t=s[r]),chrome.storage.local.set({[r]:a})},M=async()=>{let e=[],r=await chrome.storage.local.get("listed_vehicles");r&&r?.listed_vehicles&&(e=r?.listed_vehicles);let t=e.map(e=>e?.vehicle_url);return t},F=async()=>{let e=[],r=await chrome.storage.local.get("listed_vehicles");r&&r?.listed_vehicles&&(e=r?.listed_vehicles);let t=e?.map(e=>e?.vehicle_title);return t},j=async e=>{let r=[];try{let t=await fetch(`https://social-auto-server.vercel.app/api/allClients/${e}`),a=await t.json();a=a[0];let{postedWebsites:s}=a;s.length>0&&(r=s)}catch(e){console.log(e)}return r};function O(e,r){return r.filter(r=>e.includes(r.websiteUrl))}async function L(e){try{let r=await fetch("https://social-auto-server.vercel.app/api/allSites"),t=await r.json(),a=O(e,t);chrome.storage.local.set({allowedSitesData:a})}catch(e){console.log(e)}}function U(e){return e.filter((r,t)=>e.indexOf(r)===t)}async function $(){let e=await chrome.storage.local.get("siteDetails");if(e){let r=e.siteDetails;return r}}async function q(e){let r=await chrome.storage.local.get("facebook_groups");if(0===Object.keys(r).length)await chrome.storage.local.set({facebook_groups:[e]});else{let t=r.facebook_groups,a=Array.from(new Set([...t,e]));await chrome.storage.local.set({facebook_groups:a})}}async function N(e){await chrome.storage.local.set({facebookGroup:e})}function R(e,r){try{for(let t=0;t<e?.length;t++){let a=e[t]?.textContent||e[t]?.innerText||"";if(a?.trim()===r)return e[t]}return null}catch(e){return console.error("Error finding div with text:",e),null}}async function B(e,r){let t=await chrome.storage.local.get("password"),a=t?.password?.replace(/\"/g,""),s=await chrome.storage.local.get("userId"),o=s?.userId?.replace(/\"/g,""),l=function(e){let r=e.match(/vehicledetail\/([a-zA-Z0-9\-]+)/);if(r&&r[1]){let e=r[1].replace(/[^0-9]/g,"");if(e)return Number(e)}return Math.floor(1e6*Math.random())}(e);try{await fetch("https://sag.gemquery.com/webhook/automotive",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({extension_user_id:o,password:a,type:"listed_vehicle",vin:l,vehicle_url:e,listed_at:r})})}catch(e){console.error(e)}}let W=e=>{try{return e?.replace(/\\|"|\\r/g,"")}catch(e){return console.error("Error cleaning string:",e),""}};function V(e){if(!e)return"";let r=e.replace(/\\n/g,"\n"),t=r.replace(/\s+/g," "),a=t.replace(/\n+/g,"\n").trim();return a}async function G(e){try{let r=new DataTransfer;for(let t of e){let e=await (0,s.runTimeMessage)({message:"SET_BLOB_FROM_URL",data:{imageUrl:t}}),a=await fetch(e?.data);if(!a.ok)continue;let o=await a.blob(),l=new File([o],`${+new Date}.jpg`,{type:"image/webp"});l.size>4194304||(r.items.add(l),await c(.1))}await new Promise(e=>setTimeout(e,100));let t=document.querySelector('input[type="file"]');t.files=r.files,t.dispatchEvent(new Event("change",{bubbles:!0}))}catch(e){console.error("Error uploading images:",e)}}function H(e){let r=e?.replace(/[\u00ae$&*()@]/g,"")?.replace(/(===+|----+)/g,"")?.replace(/\u00A0/g," ")?.replace(/\s+/g," ")?.trim(),t=r?.replace(/,\s*/g,",\n")?.replace(/:\s*/g,":\n")?.replace(/\.\s*/g,".\n")?.replace(/\*\s*/g,"\n* ")?.replace(/======/g,"\n======")?.replace(/\s+======/g,"\n======");return t}function z(e){if(!e)return"";let r=e.replace(/\\n/g," ").replace(/\n/g," ");r=(r=(r=r.replace(/[^a-zA-Z0-9.,!? ]/g,"")).replace(/\s+/g," ").trim()).toLowerCase().replace(/(^\s*[a-z])|([.!?]\s*[a-z])/g,e=>e.toUpperCase());let t=r.split(" ");return t.length>200&&(r=t.slice(0,200).join(" ")),r}async function Z(){try{await c(1);let e=!1,r=document.querySelectorAll('a[role="tab"]');r?.forEach(async r=>{if(!e&&r?.innerText){let t=r?.innerText.trim()?.toLowerCase();t?.includes("discussion")&&(r?.click(),e=!0,await c(1))}}),e||console.warn("No discussion tab found.")}catch(e){console.error("Error clicking the discussion tab:",e)}}async function J(e){try{let r=new DataTransfer;for(let t of e){let e=await (0,s.runTimeMessage)({message:"SET_BLOB_FROM_URL",data:{imageUrl:t}}),a=await fetch(e?.data);if(!a.ok)continue;let o=await a.blob(),l=new File([o],`${+new Date}.jpg`,{type:"image/webp"});l.size>4194304||(r.items.add(l),await c(.1))}await new Promise(e=>setTimeout(e,100));let t=document.querySelectorAll('input[type="file"]');if(!t.length){console.error("No file input elements found!");return}for(let e=0;e<t.length;e++){let a=t[e];if(!a){console.warn(`File input at index ${e} is undefined`);continue}a.files=r.files,a.dispatchEvent(new Event("change",{bubbles:!0}))}}catch(e){console.error("Error uploading images:",e)}}async function Q(){try{let e,r;let t=await chrome.storage.local.get("facebookGroup"),a=await chrome.storage.local.get("whereToPost");t&&(e=t?.facebookGroup?.replace(/\"/g,"")),a&&(r=a?.whereToPost?.replace(/\"/g,"")),r||(r="FB Marketplace");let s={facebookGroup:e,whereToPost:r};return s}catch(e){return console.error("Error fetching where to post data:",e),{facebookGroup:null,whereToPost:null}}}async function Y(e){try{let r=await chrome.storage.local.get("facebook_groups")||[];if(0===Object.keys(r).length)throw Error("No groups found in local storage");for(let t of r?.facebook_groups)if(t?.name===e)return t?.url;throw Error(`Group title "${e}" not found`)}catch(e){return console.error("Error in getGroupUrl:",e.message),"Error: Unable to retrieve group URL"}}async function K(e){try{let r=await chrome.storage.local.get("shouldAddInstructions"),t=`Here is the vehicle information:
${e}

Please generate a clear and straightforward description for this vehicle using one of the following templates chosen at random. Replace {year}, {make}, {model}, {mileage}, and {price} with the actual details from the vehicle information. Focus on key details without using overly fancy language and ensure the final description is between 80 and 100 words.

Template 1:
"For sale: {year} {make} {model} with {mileage} miles. Priced at $ {price}, this vehicle offers reliable all-wheel drive and a spacious interior that comfortably seats up to eight passengers. It comes with standard safety and convenience features. Please contact for further details or to schedule a viewing."

Template 2:
"Available now: a {year} {make} {model} with {mileage} miles on the odometer. Offered at $ {price}, this SUV provides all-wheel drive for steady performance in various conditions. It features a roomy cabin designed for up to eight occupants along with essential safety and comfort options. Get in touch if you need more information or wish to inspect the vehicle."

Template 3:
"Selling a {year} {make} {model} with {mileage} miles. This vehicle is priced at $ {price} and is equipped with all-wheel drive for dependable handling. The {model} includes a well-proportioned interior that can accommodate up to eight people, along with the necessary features for everyday driving. Contact us for additional information or to arrange a test drive."

Template 4:
"Offering a {year} {make} {model} for sale with {mileage} miles. The asking price is $ {price}. This SUV comes with all-wheel drive, a spacious cabin that fits up to eight passengers, and essential features for safety and ease of driving. If you are interested or require more details, please reach out."

Focus on the key details provided in the vehicle information and ensure the final output is between 80 and 100 words.`;if(r?.shouldAddInstructions==="true"){let e=await chrome.storage.local.get("description"),r=e?.description?.replace(/\"/g,"");if(r){let e=`Seller Instructions:
${r}

Default Description Prompt:
${t}

Consider both sections when generating the final description.`;return e}}return t}catch(e){return console.error("Error in preparePromptForOpenAI:",e),"Error generating prompt"}}async function X(e,r){try{var t;let a=e?.split(",")?.map(e=>e?.trim());await chrome.storage.local.set({allowedWebsites:a});let s=await fetch("https://sag.gemquery.com/api/v1/get-website"),o=await s.json(),l=(t=o.websites,t?.filter(e=>a?.includes(e?.website_url)));"hamzamaqbool@gmail.com"==r?await chrome.storage.local.set({siteDetails:o.websites}):await chrome.storage.local.set({siteDetails:l})}catch(e){console.error(e)}}async function ee(e,r){try{await q({name:r,url:e})}catch(e){console.log(e)}}function er(e){try{let r=e?.split("\n"),t=r?.filter(e=>{let r=e?.trim();return!r?.toLowerCase()?.startsWith("view")&&!r?.toLowerCase()?.endsWith("ago")}),a=t?.join(" ")?.trim();return a=a?.replace(/You last visited/gi,"")?.trim()}catch(e){return console.error("An error occurred while extracting the title:",e),"Error: Unable to extract title"}}async function et(e,r){let t;return chrome.runtime.sendMessage({message:"fetchData",url:"https://sag.gemquery.com/api/v1/get-client",userId:e,password:r},function(e){t=e?.data}),t}async function ea(){let e=await chrome.storage.local.get("facebook_groups");if(Object?.keys(e)?.length===0)return[];let r=e?.facebook_groups,t=r.map(e=>e?.url);return t}async function es(e,r){let t;let a=e?.parentElement,s=a?.href,o=e.querySelector("a"),l=o?o.href:e?.href;l&&(t=l),s&&(t=s);try{let e=await M();await F(),r(e?.includes(t))}catch(e){console.error("Error checking if vehicle was posted:",e)}}async function eo(e,r){let t=e.element,a=t.querySelector("a"),s=a?a.href:t?.href?.trim()?.replace('"',"")?.replace('"',"");try{let e=await ea();r(e?.includes(s))}catch(e){console.error("Error checking if vehicle was posted:",e)}}async function el(e,r){let t=await fetch(e,r);if(!t.ok)throw Error(`HTTP error! status: ${t.status}`);return await t.json()}async function en(){try{let e="https://www.facebook.com/marketplace/create/vehicle",r=e,t=await Q(),{whereToPost:a,facebookGroup:s}=t;if(!a)throw Error("whereToPost is not defined");if("FB Marketplace"===a)r=e;else if("FB Groups"===a){if(!s)throw Error("facebookGroup is not defined for FB Groups");let e=await Y(s);if(!e)throw Error(`Unable to retrieve URL for group: ${s}`);r=e}else if("FB Profile/Page"===a)r="https://www.facebook.com/";else throw Error(`Invalid whereToPost value: ${a}`);return r}catch(e){return console.error("Error in getFBUrl:",e.message),"https://www.facebook.com/"}}async function ei(e){let r="",t=await K(e);t=t.replaceAll("title:","description").replaceAll("title","description").replaceAll("Title:","description").replaceAll("Title","description").replaceAll("TITLE","description");let a=await chrome.storage.local.get("userId"),s=a.userId?.replace(/\"/g,""),o=await chrome.storage.local.get("password"),l=o.password?.replace(/\"/g,"")||"",n={extension_user_id:s,password:l,system_prompt:"You are a professional car description writer, generate concise and sales-focused descriptions",user_prompt:t,model:"gpt-4o-mini"};try{let e=await el("https://sag.gemquery.com/api/v1/generate-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});e.success?r=e.text_response.trim():console.error("Failed to generate AI description:",e.error)}catch(e){console.error("Error during API call:",e)}return r}async function ec(){let e=await chrome.storage.local.get("userId"),r=e?.userId?.replace(/\"/g,""),t=await chrome.storage.local.get("password"),a=t?.password?.replace(/\"/g,""),s=r.trim(),o=a.trim(),l=await fetch("https://sag.gemquery.com/api/v1/get-client",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({extension_user_id:s,password:o})}),n=await l.json();return n}async function eg(e,r,t){let a=await M();if(!a?.includes(e)){let a={listed_at:r,salesman_name:null,vehicle_url:e,vin:"123",vehicle_title:t},s=await chrome.storage.local.get("listed_vehicles");if(s?.listed_vehicles){let e=Array.from(new Set([...s.listed_vehicles,a]));await chrome.storage.local.set({listed_vehicles:e})}else await chrome.storage.local.set({listed_vehicles:[a]})}}async function em(e){try{let r=await chrome.storage.local.get("howToPost"),t=r?.howToPost?.replace(/\"/g,"");if("Add to Queue"===t){let r=await chrome.storage.local.get("scraped_vehicles"),t=r?.scraped_vehicles||[],a=t?.some(r=>r?.url===e?.url);a||(t?.push(e),await chrome.storage.local.set({scraped_vehicles:t}))}}catch(e){console.error("Error saving vehicle data:",e)}}async function ep(e){try{let r=await chrome.storage.local.get("postedScrapedVehicles"),t=r?.postedScrapedVehicles||[],a=t?.some(r=>r?.url===e?.url);a||(t?.push(e),await chrome.storage.local.set({postedScrapedVehicles:t}))}catch(e){console.error("Error updating vehicle data:",e)}}function eu(e,r,t,a){let s=e.filter(e=>!!e&&!e.includes(".gif")).map(e=>e.trim());return r&&t&&(s=s.map(e=>e.replace(r,t))),a&&(s=s.map(e=>e.replace(a,""))),s=i(s),[...new Set(s)]}},{"~common/browserMethods":"92Ssc","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],"92Ssc":[function(e,r,t){var a=e("@parcel/transformer-js/src/esmodule-helpers.js");a.defineInteropFlag(t),a.export(t,"getAiDescriptionFromText",()=>m),a.export(t,"setLocalStorage",()=>p),a.export(t,"getLocalStorage",()=>u),a.export(t,"tabMessage",()=>A),a.export(t,"runTimeMessage",()=>h),a.export(t,"setBlobStorage",()=>d),a.export(t,"getBlogStorage",()=>f),a.export(t,"getBlobFromImgUrl",()=>g);var s=e("webextension-polyfill"),o=a.interopDefault(s),l=e("~utils/helping");let n="social_auto_group",i=o.default.storage.local;async function c(e){return new Promise((r,t)=>{let a=new FileReader;a.onloadend=()=>r(a?.result),a.readAsDataURL(e)})}let g=async e=>{let r=await fetch(e)?.then(e=>e?.blob());return await c(r)},m=async e=>{let r=await (0,l.AIDescription)(e);return r};async function p(e){await i.set({[n]:e})}async function u(){let e=await i.get();return e[n]}async function d(e){await i.set({imageBlog:e})}async function f(){let e=await i.get();return e.imageBlog}async function A(e){let r=await (0,o.default).tabs.query({active:!0});return await (0,o.default).tabs.sendMessage(r[0].id,{...e})}async function h(e){try{let r=await (0,o.default).runtime.sendMessage(e);return r}catch(e){throw console.error("Runtime message error:",e),e}}},{"webextension-polyfill":"hkciQ","~utils/helping":"eBThj","@parcel/transformer-js/src/esmodule-helpers.js":"cHUbl"}],hkciQ:[function(r,t,a){var s;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,s=function(e){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw Error("This script should only be loaded in a browser extension.");globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id?e.exports=globalThis.browser:e.exports=(e=>{let r={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(r).length)throw Error("api-metadata.json has not been included in browser-polyfill");class t extends WeakMap{constructor(e,r){super(r),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}let a=e=>e&&"object"==typeof e&&"function"==typeof e.then,s=(r,t)=>(...a)=>{e.runtime.lastError?r.reject(Error(e.runtime.lastError.message)):t.singleCallbackArg||a.length<=1&&!1!==t.singleCallbackArg?r.resolve(a[0]):r.resolve(a)},o=e=>1==e?"argument":"arguments",l=(e,r)=>function(t,...a){if(a.length<r.minArgs)throw Error(`Expected at least ${r.minArgs} ${o(r.minArgs)} for ${e}(), got ${a.length}`);if(a.length>r.maxArgs)throw Error(`Expected at most ${r.maxArgs} ${o(r.maxArgs)} for ${e}(), got ${a.length}`);return new Promise((o,l)=>{if(r.fallbackToNoCallback)try{t[e](...a,s({resolve:o,reject:l},r))}catch(s){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,s),t[e](...a),r.fallbackToNoCallback=!1,r.noCallback=!0,o()}else r.noCallback?(t[e](...a),o()):t[e](...a,s({resolve:o,reject:l},r))})},n=(e,r,t)=>new Proxy(r,{apply:(r,a,s)=>t.call(a,e,...s)}),i=Function.call.bind(Object.prototype.hasOwnProperty),c=(e,r={},t={})=>{let a=Object.create(null),s=Object.create(e);return new Proxy(s,{has:(r,t)=>t in e||t in a,get(s,o,g){if(o in a)return a[o];if(!(o in e))return;let m=e[o];if("function"==typeof m){if("function"==typeof r[o])m=n(e,e[o],r[o]);else if(i(t,o)){let r=l(o,t[o]);m=n(e,e[o],r)}else m=m.bind(e)}else if("object"==typeof m&&null!==m&&(i(r,o)||i(t,o)))m=c(m,r[o],t[o]);else{if(!i(t,"*"))return Object.defineProperty(a,o,{configurable:!0,enumerable:!0,get:()=>e[o],set(r){e[o]=r}}),m;m=c(m,r[o],t["*"])}return a[o]=m,m},set:(r,t,s,o)=>(t in a?a[t]=s:e[t]=s,!0),defineProperty:(e,r,t)=>Reflect.defineProperty(a,r,t),deleteProperty:(e,r)=>Reflect.deleteProperty(a,r)})},g=e=>({addListener(r,t,...a){r.addListener(e.get(t),...a)},hasListener:(r,t)=>r.hasListener(e.get(t)),removeListener(r,t){r.removeListener(e.get(t))}}),m=new t(e=>"function"!=typeof e?e:function(r){let t=c(r,{},{getContent:{minArgs:0,maxArgs:0}});e(t)}),p=new t(e=>"function"!=typeof e?e:function(r,t,s){let o,l,n=!1,i=new Promise(e=>{o=function(r){n=!0,e(r)}});try{l=e(r,t,o)}catch(e){l=Promise.reject(e)}let c=!0!==l&&a(l);return(!0===l||!!c||!!n)&&((e=>{e.then(e=>{s(e)},e=>{s({__mozWebExtensionPolyfillReject__:!0,message:e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred"})}).catch(e=>{console.error("Failed to send onMessage rejected reply",e)})})(c?l:i),!0)}),u=({reject:r,resolve:t},a)=>{e.runtime.lastError?"The message port closed before a response was received."===e.runtime.lastError.message?t():r(Error(e.runtime.lastError.message)):a&&a.__mozWebExtensionPolyfillReject__?r(Error(a.message)):t(a)},d=(e,r,t,...a)=>{if(a.length<r.minArgs)throw Error(`Expected at least ${r.minArgs} ${o(r.minArgs)} for ${e}(), got ${a.length}`);if(a.length>r.maxArgs)throw Error(`Expected at most ${r.maxArgs} ${o(r.maxArgs)} for ${e}(), got ${a.length}`);return new Promise((e,r)=>{let s=u.bind(null,{resolve:e,reject:r});a.push(s),t.sendMessage(...a)})},f={devtools:{network:{onRequestFinished:g(m)}},runtime:{onMessage:g(p),onMessageExternal:g(p),sendMessage:d.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:d.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},A={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return r.privacy={network:{"*":A},services:{"*":A},websites:{"*":A}},c(e,f,r)})(chrome)},"function"==typeof e&&e.amd?e("webextension-polyfill",["module"],s):s(t)},{}],cHUbl:[function(e,r,t){t.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},t.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.exportAll=function(e,r){return Object.keys(e).forEach(function(t){"default"===t||"__esModule"===t||r.hasOwnProperty(t)||Object.defineProperty(r,t,{enumerable:!0,get:function(){return e[t]}})}),r},t.export=function(e,r,t){Object.defineProperty(e,r,{enumerable:!0,get:t})}},{}]},["VvubE"],"VvubE","parcelRequirefe72"),globalThis.define=r;